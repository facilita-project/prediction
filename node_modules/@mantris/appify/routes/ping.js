'use strict'

const env = require('sugar-env')

const HEADER_CONFIG = 'x-config'
const HEADER_UPTIME = 'x-uptime'
const HEADER_ENVIRONMENT = 'x-environment'
const HEADER_SERVICE_NAME = 'x-service-name'

const factory = (config, environment) => (req, res) => {
  res.set({
    [HEADER_SERVICE_NAME]: config.name,
    [HEADER_UPTIME]: Math.floor(process.uptime())
  })

  if (env(environment).is(env.DEVELOPMENT)) {
    res.set({
      [HEADER_ENVIRONMENT]: environment,
      [HEADER_CONFIG]: JSON.stringify(config)
    })
  }

  res.send('Pong!')
}

module.exports = { factory }
