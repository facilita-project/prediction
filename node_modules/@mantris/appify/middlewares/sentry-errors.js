'use strict'

const Raven = require('raven')
const HttpError = require('../errors/http-error')

const factory = () => (err, req, res, next) => {
  if (err instanceof HttpError) {
    return next(err)
  }

  if (!Raven.installed) {
    return next(err)
  }

  return Raven.errorHandler()(err, req, res, next)
}

module.exports = { factory }
